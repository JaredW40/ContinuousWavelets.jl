var documenterSearchIndex = {"docs":
[{"location":"coreType/#Wavelet-types","page":"Available Wavelets","title":"Wavelet types","text":"","category":"section"},{"location":"coreType/","page":"Available Wavelets","title":"Available Wavelets","text":"There are two tiers of wavelet types in this package. The most abstract is the ContWave type, representing a class of wavelets","category":"page"},{"location":"coreType/","page":"Available Wavelets","title":"Available Wavelets","text":"ContWave","category":"page"},{"location":"coreType/#ContinuousWavelets.ContWave","page":"Available Wavelets","title":"ContinuousWavelets.ContWave","text":"ContWave{Boundary,T}\n\nThe abstract type encompassing the various types of wavelets implemented in  the package. The abstract type has parameters Boundary<:WaveletBoundary and T<:Number, which gives the element output type. Each has both a constructor, and a default predefined entry. These are:\n\nMorlet: A complex approximately analytic wavelet that is just a frequency   domain Gaussian with mean subtracted. Morlet(σ::T) where T<: Real. σ   gives the frequency domain variance of the mother Wavelet. As σ goes to   zero, all of the information becomes spatial. Default is morl which has   σ=2π.\nPaul{N}: A complex analytic wavelet. pauln for n in 1:20 e.g. paul5\nDog{N}: Derivative of a Gaussian, where N is the number of   derivatives. dogn for n in 0:6. The Sombrero/mexican hat/Marr wavelet   is n=2.\nContOrtho{OWT}. OWT is some orthogonal wavelet of type OrthoWaveletClass   from Wavelets.jl. This uses an   explicit construction of the mother wavelet for these orthogonal wavelets   to do a continuous transform. Constructed via ContOrtho(o::W) where o   is from Wavelets.jl. Alternatively, you can get them directly as   ContOrtho objects via:\ncHaar Haar Wavelets\ncBeyl Beylkin Wavelets\ncVaid Vaidyanthan Wavelets\ncDbn Daubhechies Wavelets. n ranges from 1:Inf\ncCoifn Coiflets. n ranges from 2:2:8\ncSymn Symlets. n ranges from 4:10\ncBattn Battle-Lemarie wavelets. n ranges from 2:2:6\n\n\n\n\n\n","category":"type"},{"location":"coreType/","page":"Available Wavelets","title":"Available Wavelets","text":"using ContinuousWavelets, Plots, Wavelets, FFTW, Logging\nusing Plots; gr()\nPlots.reset_defaults()\nglobal_logger(Logging.SimpleLogger(stderr,Logging.Error))\nn= 2047;\nfunction mapTo(waveType, isReal=true,window=2047-100:2047+100;d=2)\n\tif isReal\n\t\tc = wavelet(waveType,averagingType=NoAve(),β=d)\n\t\tmorlet,ω = computeWavelets(n,c)\n\t\treturn ifftshift(irfft(morlet,2*n,1))[window,:]\n\telse\n\t\tc = wavelet(waveType,averagingType=NoAve(),β=d)\n\t\tmorlet,ω = computeWavelets(n,c)\n\t\treturn ifftshift(ifft(morlet,1))[window,:]\n\tend\nend\ntmp = mapTo(Morlet(π),false, 1024-50:1024+50)[:,2]\np1=plot([real.(tmp) imag.(tmp)],title=\"Morlet\",\n\tlabels=[\"real\" \"imaginary\"],ticks=nothing,linewidth=5);\ntmp = mapTo(paul2,false, 1024-50:1024+50)[:,4]\np2=plot([real.(tmp) imag.(tmp)],title=\"Paul 2\",\n\tlabels=[\"real\" \"imaginary\"],ticks=nothing,linewidth=5);\np3=plot(mapTo(dog2)[:,2],title=\"derivative of gaussians (dog2)\",legend=false,ticks=nothing,linewidth=5);\np4=plot(mapTo(cHaar)[:,2],title=\"Haar\",legend=false,ticks=nothing,linewidth=5);\np5=plot(mapTo(cBeyl;d=1)[:,1],title=\"Beylkyin\",legend=false,ticks=nothing,linewidth=5);\np6=plot(mapTo(cVaid;d=1)[:,1],title=\"Vaidyanthan\",legend=false,ticks=nothing,linewidth=5);\np7=plot(mapTo(cDb2;d=1)[:,1],title=\"Daubhechies 2\",legend=false,ticks=nothing,linewidth=5);\np8=plot(mapTo(cCoif2;d=1)[:,1],title=\"Coiflet 2\",legend=false,ticks=nothing,linewidth=5);\np9=plot(mapTo(cSym4;d=1)[:,1],title=\"Symlet 4\",legend=false,ticks=nothing,linewidth=5);\np10=plot(mapTo(cBatt4;d=1)[:,2],title=\"Battle-Lemarie, 4\",legend=false,ticks=nothing,linewidth=5);\nplot(p1,p2,p3,p4,p5,p6,p7,p8,p9,p10,layout=(2,5),size=300 .*(5, 2.2));\nsavefig(\"mothers.svg\")#hide","category":"page"},{"location":"coreType/","page":"Available Wavelets","title":"Available Wavelets","text":"(Image: ) Above are examples of every mother wavelet defined in this package; the only analytic and/or complex wavelets are the Morlet and the Paul wavelets. Once you have chosen a type of wavelet, this is used to construct the more specific CWT, which specifies more details of the transform, such as frequency spacing, whether to include an averaging filter or not, a frame upper bound, etc.","category":"page"},{"location":"bound/#Boundary-types","page":"Boundary Conditions","title":"Boundary types","text":"","category":"section"},{"location":"bound/","page":"Boundary Conditions","title":"Boundary Conditions","text":"WaveletBoundary\nPerBoundary\nZPBoundary\nSymBoundary","category":"page"},{"location":"bound/#ContinuousWavelets.WaveletBoundary","page":"Boundary Conditions","title":"ContinuousWavelets.WaveletBoundary","text":"the abstract type for the various types of boundaries\n\n\n\n\n\n","category":"type"},{"location":"bound/#ContinuousWavelets.PerBoundary","page":"Boundary Conditions","title":"ContinuousWavelets.PerBoundary","text":"PerBoundary() <: WaveletBoundary\n\nstandard periodic boundary assumption made by the fft. Aliases of NaivePer and Periodic.\n\n\n\n\n\n","category":"type"},{"location":"bound/#ContinuousWavelets.ZPBoundary","page":"Boundary Conditions","title":"ContinuousWavelets.ZPBoundary","text":"ZPBoundary() <: WaveletBoundary\n\nzero pads the signal before doing an fft, rounding up to the nearest power of two. Alias of padded.\n\n\n\n\n\n","category":"type"},{"location":"bound/#ContinuousWavelets.SymBoundary","page":"Boundary Conditions","title":"ContinuousWavelets.SymBoundary","text":"SymBoundary() <: WaveletBoundary\n\nsymmetric boundary, as in the DCT type II. Repeats the edge value, which alleviates derivative discontinuities. Alias of DEFAULT_BOUNDARY and SymBound.\n\n\n\n\n\n","category":"type"},{"location":"installation/#Installation","page":"Install","title":"Installation","text":"","category":"section"},{"location":"installation/","page":"Install","title":"Install","text":"At the moment this package is unregistered, so you will have to do it the hard way. Either press ] and run","category":"page"},{"location":"installation/","page":"Install","title":"Install","text":"(@v9.9) pkg> add https://github.com/dsweber2/ContinuousWavelets.jl.git","category":"page"},{"location":"installation/","page":"Install","title":"Install","text":"or download via git e.g. git clone https://github.com/dsweber2/ContinuousWavelets.jl.git.","category":"page"},{"location":"CWTConstruction/#CWT-type","page":"CWT Type","title":"CWT type","text":"","category":"section"},{"location":"CWTConstruction/","page":"CWT Type","title":"CWT Type","text":"\nCWT\nContinuousWavelets.wavelet","category":"page"},{"location":"CWTConstruction/","page":"CWT Type","title":"CWT Type","text":"There are many parameters that go into designing a continuous wavelet transform.","category":"page"},{"location":"CWTConstruction/","page":"CWT Type","title":"CWT Type","text":"wave::ContWaveClass: is a type of continuous wavelet,  see (Image: Wavelet types).\nscalingFactor, s, or Q::Real=8.0: the number of wavelets between the octaves 2^J and 2^J+1 (defaults to 8, which is most appropriate for music and other audio). Valid range is (0infty).\nβ::Real=4.0: As using exactly Q wavelets per octave leads to excessively many low-frequency wavelets, β varies the number of wavelets per octave, with larger values of β corresponding to fewer low frequency wavelets(see Wavelet Spacing for details). Valid range is (1infty), though around β=6 the spacing is approximately linear in frequency, rather than log-frequency, and begins to become concave after that.\nboundary::WaveletBoundary=SymBo: The default boundary condition is SymBoundary(), implemented by appending a flipped version of the vector at the end to eliminate edge discontinuities.\naveragingType::Average=Father(): determines whether or not to include the averaging function, and if so, what kind of averaging. The options are\nFather: use the averaging function that corresponds to the Mother Wavelet.\nDirac: use the sinc function with the appropriate width.\nNoAve: don't average. this has one fewer filters than the other averagingTypes\naveragingLength::Int=4:  the number of wavelet octaves that are covered by the averaging, \nframeBound::Real=1: gives the total norm of the whole collection, corresponding to the upper frame bound; if you don't want to impose a particular bound, set frameBound<0.\nnormalization or p::Real=Inf: the p-norm preserved as the scale changes, so if we're scaling by s, normalization has value p, and the mother wavelet is psi, then the resulting wavelet is s^1ppsi(^t_s). The default scaling, Inf gives all the same maximum value in the frequency domain. Valid range is (0infty), though p1 isn't actually preserving a norm.","category":"page"},{"location":"#ContinuousWavelets-Documentation","page":"basic usage","title":"ContinuousWavelets Documentation","text":"","category":"section"},{"location":"","page":"basic usage","title":"basic usage","text":"Originally included in Wavelets.jl, this is a fork containing the types and methods specifically for doing continuous wavelet transforms. Current methods only include 1D wavelet transforms and their inverses.","category":"page"},{"location":"","page":"basic usage","title":"basic usage","text":"The basic structure is similar to that of Wavelets.jl; first you choose one of the (Image: Wavelet types) of the ContWaveClass type, e.g. Morlet(2π). Then you set the general transform parameters by constructing a (Image: CWT type), which specifies such properties as whether to average, the scaling rate, or the boundary conditions. Finally, you perform the actual transform withcwt.","category":"page"},{"location":"","page":"basic usage","title":"basic usage","text":"using Plots; gr()#hide\nPlots.reset_defaults()#hide\nusing ContinuousWavelets, Plots, Wavelets, FFTW\nusing Logging#hide\nglobal_logger(Logging.SimpleLogger(stderr,Logging.Error))#hide\nn=2047;\nf = testfunction(n, \"Doppler\");\np1=plot(f,legend=false,title=\"Doppler\",xlims=(0,2000));\nc = wavelet(Morlet(π), averagingType=NoAve(), β=2);\nres = cwt(f, c)\np2=heatmap(abs.(res)', xlabel= \"time index\", \n\tylabel=\"frequency index\",colorbar=false);\nl=@layout [a{.3h};b{.7h}]\nplot(p1,p2,layout=l);\nsavefig(\"doppler.svg\");#hide","category":"page"},{"location":"","page":"basic usage","title":"basic usage","text":"(Image: )","category":"page"},{"location":"","page":"basic usage","title":"basic usage","text":"","category":"page"},{"location":"spacing/#Wavelet-Frequency-spacing","page":"Wavelet Spacing","title":"Wavelet Frequency spacing","text":"","category":"section"},{"location":"spacing/","page":"Wavelet Spacing","title":"Wavelet Spacing","text":"Frequently, using a fixed ratio for scaling the wavelets results in too many large scale wavelets. There are several ways of dealing with this; in this package, the scaling factors have the form 2^a(mx+x_0)^^1_beta, for suitable choice of a,m, x_0, and beta.  The figure gives an example of the chosen scaling factors in log frequency. ","category":"page"},{"location":"spacing/","page":"Wavelet Spacing","title":"Wavelet Spacing","text":"using ContinuousWavelets, Plots, Wavelets, FFTW, LaTeXStrings, Logging\nusing Plots; gr()\nPlots.reset_defaults()\nglobal_logger(Logging.SimpleLogger(stderr,Logging.Error))\ndRate = 4\nwaveType = Morlet()\nΨ1 = wavelet(waveType, s=8, β =dRate, averagingLength=2)\npyplot()\nlocs = ContinuousWavelets.polySpacing(8,Ψ1);\nscatter(1:length(locs), locs, legend=:bottomright, label=\"mean log frequency\",\n        xlabel=\"Wavelet Index (x)\", ylabel= \"log-Frequency (y)\", color=:black)\nscatter!(length(locs):length(locs),locs[end:end],markersize=10,markershape=:x,color=:black, label=:none)\nfirstW, lastW,stepS = ContinuousWavelets.genSamplePoints(8,Ψ1)\nb = (dRate/Ψ1.Q)^(1 ./dRate)*(8+Ψ1.averagingLength)^((dRate-1)/dRate)\nt= range(1,stop=length(locs),step=.1)\ncurve = b .*(range(firstW,stop=(locs[end]/b)^dRate,length=length(t))).^(1 / dRate)\nplot!(t, curve, color=:blue, line=:dash, label=L\"y=a(mx+x_0)^{^1/_\\beta}\",\n      legend=:bottomright,\n      xrange=(0,length(locs)+3), xticks= [1; 5:5:1+length(locs)...],\n      yrange=(minimum(locs)-1, maximum(locs)+1),\n      yticks=(2:2:10,[\"Ave.Length\", (4:2:8)..., \"N.Octaves\"]));\nx = range(15, stop=28, step=.5)\ny(x)= curve[end] .+ b/dRate*24 .^(1/dRate-1).*(x .-24)\nplot!(x, y(x), c=:black,line=2,label=:none);\nannotate!(length(locs)-.125, locs[end]+7/16, \n          Plots.text(L\"\\frac{dy}{dx}=^{1}/_{Q}\", 9, :black, :center));\nsavefig(\"plotOfLogCentralFrequencies.svg\")","category":"page"},{"location":"spacing/","page":"Wavelet Spacing","title":"Wavelet Spacing","text":"(Image: )","category":"page"},{"location":"spacing/","page":"Wavelet Spacing","title":"Wavelet Spacing","text":"If beta is 1, then we have a linear relation between the index and the log-frequency, and Q gives exactly the number of wavelets per octave throughout. As beta increases, the wavelets skew more and more heavily to high frequencies. The default value is 4.","category":"page"},{"location":"spacing/","page":"Wavelet Spacing","title":"Wavelet Spacing","text":"The user chooses beta, Q (the number of wavelets per octave at the last point), and Ave. Length (the number of octaves covered by the averaging function), and then a, m, x_0, and the total number of wavelets N_w are chosen so that:","category":"page"},{"location":"spacing/","page":"Wavelet Spacing","title":"Wavelet Spacing","text":"The first wavelet is scaled by 2^textrmAve Length, so the curve  a(mx+x_0)^^1_beta goes through the point   (xy)=(1textrmAve Length).\nThe derivative fracmathrmdymathrmdx at the last point is  frac1Q, so the \"instantaneous\" number of wavelets x per octave y  is Q. Each type of wavelet has a maximum scaling 2^N_Octaves  returned by getNOctaves (generally half the signal length), so the final  point N_w satisfies both y(N_w) = N_Octaves and  y(N_w)=^1_Q.\nFinally, the spacing is chosen so that there are exactly Q wavelets in the last octave.","category":"page"},{"location":"spacing/","page":"Wavelet Spacing","title":"Wavelet Spacing","text":"If you are interested in the exact computation, see the function polySpacing. As some examples of how the wavelet bank changes as we change beta:","category":"page"},{"location":"spacing/","page":"Wavelet Spacing","title":"Wavelet Spacing","text":"n=2047\nΨ1 = wavelet(morl, s=8, β=1)\nd1, ξ = computeWavelets(n,Ψ1)\nΨ2 = wavelet(morl, s=8, β =2)\nd2, ξ = Wavelets.computeWavelets(n,Ψ2)\nΨ4 = wavelet(morl, s=8, β =4)\nd4, ξ = Wavelets.computeWavelets(n,Ψ4)\nmatchingLimits = (minimum([d1 d2 d4]), maximum([d1 d2 d4]))# for \nplot(heatmap(1:size(d1,2), ξ, d1, color=:Greys, \n             yaxis = (L\"\\omega\", ), \n             xaxis = (\"wavelet index\", ),\n             title=L\"\\beta=1\"*\" (\"*L\"\\Psi1\"*\")\", colorbar=false,\n             clims=matchingLimits),\n     heatmap(1:size(d2,2), ξ, d2, color=:Greys, \n             yticks=[], \n             xaxis = (\"wavelet index\", ),\n             title=L\"\\beta=2\"*\" (\"*L\"\\Psi2\"*\")\", colorbar=false,\n             clims=matchingLimits), \n     heatmap(1:size(d4,2), ξ, d4,color=:Greys, yticks=[],\n             xaxis = (\"wavelet index\", ),\n             title=L\"\\beta=4\"*\" (\"*L\"\\Psi4\"*\")\"),\n     layout=(1,3),  clims=matchingLimits, \n     colorbar_title=L\"\\widehat{\\psi_i}\");#hide\nsavefig(\"changeBeta.png\") #hide","category":"page"},{"location":"spacing/","page":"Wavelet Spacing","title":"Wavelet Spacing","text":"(Image: )","category":"page"},{"location":"spacing/","page":"Wavelet Spacing","title":"Wavelet Spacing","text":"note that the low-frequency coverage increases drastically as we decrease beta.","category":"page"}]
}
