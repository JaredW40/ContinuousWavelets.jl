# ContinuousWavelets

[![Build Status](https://travis-ci.com/dsweber2/ContinuousWavelets.jl.svg?branch=master)](https://travis-ci.com/dsweber2/ContinuousWavelets.jl)
[![Coverage](https://codecov.io/gh/dsweber2/ContinuousWavelets.jl/branch/master/graph/badge.svg)](https://codecov.io/gh/dsweber2/ContinuousWavelets.jl)
[![](https://img.shields.io/badge/docs-dev-blue.svg)](https://dsweber2.github.io/ContinuousWavelets.jl/dev/)

This package is an offshoot of [Wavelets.jl](https://github.com/JuliaDSP/Wavelets.jl) for the continuous wavelets.
Thanks to [Felix Gerick](https://github.com/fgerick) for the initial implementation there, with extension and further adaptation by David Weber and any other contributors listed on the right.
Currently, it implements 1D continuous wavelet transforms with the following mother wavelets:

![Mothers](docs/mothers.svg)

Which covers several standard continuous wavelet families, both real and analytic, as well as continuous versions of the orthogonal wavelet transforms implemented in [Wavelets.jl](https://github.com/JuliaDSP/Wavelets.jl).

## Basic Usage

Install via the package manager and load with `using`

```julia
julia> Pkg.add("ContinuousWavelets")
julia> using ContinuousWavelets
```

Basic usage example on a doppler test function.

```jldoctest ex
julia> using Random

julia> Random.seed!(1234)
TaskLocalRNG()

julia> using ContinuousWavelets, Plots, Wavelets

julia> gr()
Plots.GRBackend()

julia> n = 2047;

julia> t = range(0, n / 1000, length=n); # 1kHz sampling rate

julia> f = testfunction(n, "Doppler");

julia> p1 = plot(t, f, legend=false, title="Doppler", xticks=false)
Plot{Plots.GRBackend() n=1}

julia> c = wavelet(Morlet(π), β=2)

julia> res = ContinuousWavelets.cwt(f, c)
┌ Warning: the lowest frequency wavelet has more than 1% its max at zero, so it may not be analytic. Think carefully
│   lowAprxAnalyt = 0.06186323501016359
└ @ ContinuousWavelets ~/allHail/projects/ContinuousWavelets/src/sanityChecks.jl:6
2047×31 Matrix{ComplexF64}:
 -2.84943e-6+3.86436e-19im    1.44519e-5-1.62298e-9im   …   0.000125192+0.000112017im   0.000109884+9.67013e-5im
 -2.84699e-6-6.11361e-20im    1.44509e-5-4.88515e-9im       -9.89185e-5+0.000149589im   -8.24222e-5+0.000130545im
 -2.84212e-6+4.37411e-20im    1.44489e-5-8.19594e-9im      -0.000180219-7.17018e-5im   -0.000153333-5.64666e-5im
 -2.83483e-6-3.11387e-19im    1.44459e-5-1.15878e-8im        2.75325e-5-0.000205094im    1.90839e-5-0.00016841im
 -2.82514e-6-1.31096e-19im    1.44419e-5-1.5093e-8im        0.000217137-3.06784e-5im    0.000172696-2.56466e-5im
 -2.81306e-6-3.38731e-19im    1.44369e-5-1.87442e-8im   …   0.000101677+0.000208577im    7.79501e-5+0.000162848im
 -2.79865e-6-9.8753e-19im     1.44309e-5-2.25737e-8im      -0.000166245+0.0001764im    -0.000128919+0.000132755im
 -2.78192e-6+4.91292e-20im    1.44239e-5-2.66139e-8im      -0.000231546-8.56946e-5im   -0.000172323-6.71036e-5im
 -2.76293e-6+5.80924e-19im    1.44159e-5-3.08974e-8im       -1.72186e-5-0.000244897im   -9.39619e-6-0.000179998im
 -2.74172e-6+1.11752e-19im     1.4407e-5-3.54565e-8im        0.00021092-0.000117606im   0.000153988-8.14305e-5im
 -2.71834e-6+8.64638e-19im     1.4397e-5-4.03239e-8im   …   0.000195675+0.00013552im    0.000136771+0.000100468im
 -2.69286e-6-2.88793e-19im    1.43861e-5-4.5532e-8im        -2.83744e-5+0.000233507im   -2.50828e-5+0.000164744im
 -2.66533e-6+5.34316e-19im    1.43743e-5-5.11132e-8im      -0.000213057+8.89624e-5im   -0.000151709+5.84793e-5im
 -2.63582e-6+5.29943e-19im    1.43615e-5-5.71002e-8im      -0.000179848-0.000132417im  -0.000123312-9.52594e-5im
 -2.60441e-6+6.72327e-19im    1.43477e-5-6.35255e-8im        1.72944e-5-0.000212547im    1.49933e-5-0.000146198im
 -2.57118e-6-8.14626e-19im     1.4333e-5-7.04217e-8im   …   0.000180088-9.36572e-5im    0.000124188-6.08939e-5im
 -2.53619e-6-7.31847e-19im    1.43174e-5-7.78213e-8im       0.000168957+9.63885e-5im    0.000112512+6.85418e-5im
 -2.49954e-6+9.48055e-19im    1.43008e-5-8.5757e-8im         1.43881e-5+0.000187263im    5.82585e-6+0.000126977im
 -2.46131e-6-5.69704e-19im    1.42833e-5-9.42612e-8im      -0.000138611+0.000116697im    -9.5945e-5+7.63808e-5im
 -2.42159e-6+4.98603e-20im     1.4265e-5-1.03367e-7im      -0.000168713-3.84182e-5im   -0.000113223-2.82337e-5im
 -2.38048e-6+5.0207e-19im     1.42457e-5-1.13106e-7im   …   -6.90657e-5-0.000147745im   -4.47447e-5-9.94442e-5im
 -2.33806e-6-2.41155e-19im    1.42256e-5-1.23512e-7im        6.87319e-5-0.000136231im    4.66608e-5-8.94614e-5im
 -2.29443e-6+1.42336e-18im    1.42046e-5-1.34617e-7im       0.000140309-2.87995e-5im     9.23378e-5-1.71864e-5im
 -2.24969e-6-3.29723e-19im    1.41828e-5-1.46454e-7im       0.000105068+8.63091e-5im     6.73585e-5+5.8222e-5im
 -2.20394e-6+4.99968e-20im    1.41601e-5-1.59055e-7im        1.91996e-6+0.000130337im   -1.08373e-6+8.57125e-5im
 -2.15726e-6+3.03896e-19im    1.41366e-5-1.72453e-7im   …   -9.19623e-5+8.46731e-5im    -6.20145e-5+5.45369e-5im
            ⋮                                           ⋱                                          ⋮
 0.000226924+6.72565e-20im  -0.000567204+0.000135244im      -2.92608e-6-1.8462e-6im      -2.9263e-6-1.84764e-6im
 0.000222097-8.16784e-19im   -0.00056838+0.000129826im      -2.90121e-6-1.77915e-6im    -2.90141e-6-1.78055e-6im
 0.000217456-9.28746e-19im  -0.000569509+0.000124396im      -2.87686e-6-1.71155e-6im    -2.87703e-6-1.71292e-6im
 0.000213004-1.92672e-19im   -0.00057059+0.000118954im  …   -2.85305e-6-1.64338e-6im     -2.8532e-6-1.64472e-6im
 0.000208742-3.18302e-19im  -0.000571623+0.0001135im        -2.82978e-6-1.57465e-6im     -2.8299e-6-1.57595e-6im
 0.000204671-1.87724e-19im  -0.000572608+0.000108035im      -2.80707e-6-1.50533e-6im    -2.80717e-6-1.5066e-6im
 0.000200793-1.46831e-18im  -0.000573545+0.000102559im      -2.78493e-6-1.43541e-6im    -2.78501e-6-1.43665e-6im
  0.00019711-2.57567e-19im  -0.000574434+9.70736e-5im       -2.76338e-6-1.36488e-6im    -2.76343e-6-1.36609e-6im
 0.000193623-8.19003e-19im  -0.000575273+9.15781e-5im   …   -2.74244e-6-1.29372e-6im    -2.74246e-6-1.2949e-6im
 0.000190334+2.20042e-19im  -0.000576064+8.60735e-5im       -2.72211e-6-1.22192e-6im    -2.72211e-6-1.22306e-6im
 0.000187243-7.23037e-19im  -0.000576807+8.05605e-5im       -2.70243e-6-1.14944e-6im     -2.7024e-6-1.15056e-6im
 0.000184353-6.00493e-19im    -0.0005775+7.50394e-5im       -2.68341e-6-1.07628e-6im    -2.68336e-6-1.07736e-6im
 0.000181663+6.62657e-19im  -0.000578144+6.95109e-5im       -2.66507e-6-1.00241e-6im      -2.665e-6-1.00346e-6im
 0.000179177-1.3506e-18im    -0.00057874+6.39755e-5im   …   -2.64741e-6-9.27759e-7im    -2.64734e-6-9.28816e-7im
 0.000176894-5.21025e-19im  -0.000579285+5.84338e-5im       -2.63062e-6-8.52209e-7im    -2.63039e-6-8.53349e-7im
 0.000174815-7.42994e-19im  -0.000579782+5.28862e-5im       -2.61506e-6-7.76218e-7im    -2.61442e-6-7.76953e-7im
 0.000172941+2.7571e-19im   -0.000580229+4.73334e-5im       -2.59937e-6-7.00815e-7im    -2.59966e-6-7.0039e-7im
 0.000171274+1.41585e-19im  -0.000580627+4.17758e-5im       -2.58041e-6-6.22483e-7im    -2.58362e-6-6.24181e-7im
 0.000169814-7.90531e-21im  -0.000580975+3.62141e-5im   …   -2.56582e-6-5.32728e-7im    -2.56497e-6-5.41108e-7im
 0.000168561-5.81895e-20im  -0.000581273+3.06488e-5im       -2.57532e-6-4.46165e-7im    -2.56135e-6-4.4822e-7im
 0.000167516-3.07438e-19im  -0.000581522+2.50805e-5im         -2.584e-6-4.03348e-7im    -2.57801e-6-3.83539e-7im
 0.000166679-6.64104e-19im  -0.000581721+1.95096e-5im       -2.51699e-6-3.66859e-7im    -2.54192e-6-3.54776e-7im
 0.000166051-1.45091e-18im  -0.000581871+1.39368e-5im        -2.4225e-6-2.1293e-7im      -2.4431e-6-2.37279e-7im
 0.000165633+5.67188e-19im   -0.00058197+8.36266e-6im   …   -2.48306e-6+6.63823e-9im    -2.46986e-6-1.96881e-8im
 0.000165423+1.25225e-18im   -0.00058202+2.78765e-6im       -2.65444e-6+5.18306e-8im    -2.63276e-6+4.61939e-8im


```

And now we make a scalogram to actually interpret these entries:

```jldoctest ex; output=false
freqs = getMeanFreq(ContinuousWavelets.computeWavelets(n, c)[1])
freqs[1] = 0
p2 = heatmap(t, freqs, log.(abs.(res).^2)', xlabel= "time (s)", ylabel="frequency (Hz)", colorbar=false, c=cgrad(:viridis, scale=:log10))
l = @layout [a{.3h};b{.7h}]
plot(p1,p2,layout=l)

# output
┌ Warning: the lowest frequency wavelet has more than 1% its max at zero, so it may not be analytic. Think carefully
│   lowAprxAnalyt = 0.06186323501016359
└ @ ContinuousWavelets ~/allHail/projects/ContinuousWavelets/src/sanityChecks.jl:6
Plot{Plots.GRBackend() n=2}
```

![Doppler](/docs/doppler.svg)

As the cwt frame is redundant, there are many choices of dual/inverse frames. There are three available in this package, `NaiveDelta()`, `PenroseDelta()`, and `DualFrames()`. As a toy example, lets knock out the middle time of the bumps function and apply a high pass filter:

```jldoctest ex; output = false
f = testfunction(n, "Bumps");
p1 = plot(f, legend = false, title = "Bumps", xlims = (0, 2000), linewidth = 2)
c = wavelet(dog2, β = 2)
res = ContinuousWavelets.cwt(f, c)

# output

2047×27 Matrix{Float64}:
 0.00262067   -0.00150482  -2.16134e-6  -9.32656e-7  -6.06247e-7  …  -3.75559e-8   -3.42124e-8   -3.11967e-8   -2.84659e-8
 0.00262075   -0.00150528  -2.16503e-6  -9.32531e-7  -6.05646e-7     -2.985e-8     -2.61034e-8   -2.27191e-8   -1.96643e-8
 0.00262089   -0.00150621  -2.17246e-6  -9.32285e-7  -6.0445e-7      -1.90126e-8   -1.53614e-8   -1.22211e-8   -9.55694e-9
 0.00262111   -0.0015076   -2.18368e-6  -9.31925e-7  -6.02672e-7     -9.98394e-9   -7.26844e-9   -5.16474e-9   -3.5861e-9
 0.00262141   -0.00150945  -2.1988e-6   -9.31463e-7  -6.00331e-7     -4.71452e-9   -3.17363e-9   -2.13149e-9   -1.45404e-9
 0.00262177   -0.00151176  -2.21794e-6  -9.30914e-7  -5.97451e-7  …  -2.45418e-9   -1.71933e-9   -1.26651e-9   -9.85913e-10
 0.00262221   -0.00151453  -2.24129e-6  -9.30297e-7  -5.94064e-7     -1.73806e-9   -1.36213e-9   -1.11251e-9   -9.3166e-10
 0.00262272   -0.00151775  -2.26904e-6  -9.29635e-7  -5.90205e-7     -1.58516e-9   -1.31798e-9   -1.11305e-9   -9.48609e-10
 0.00262331   -0.00152143  -2.30144e-6  -9.28953e-7  -5.85916e-7     -1.58454e-9   -1.33761e-9   -1.13556e-9   -9.66579e-10
 0.00262397   -0.00152557  -2.33879e-6  -9.28282e-7  -5.81242e-7     -1.61563e-9   -1.36745e-9   -1.1622e-9    -9.92573e-10
 0.0026247    -0.00153014  -2.38141e-6  -9.27654e-7  -5.76233e-7  …  -1.65255e-9   -1.39908e-9   -1.18852e-9   -1.0115e-9
 0.0026255    -0.00153517  -2.42967e-6  -9.27105e-7  -5.70942e-7     -1.69119e-9   -1.43191e-9   -1.21709e-9   -1.03973e-9
 0.00262638   -0.00154063  -2.48401e-6  -9.26674e-7  -5.65426e-7     -1.73108e-9   -1.46559e-9   -1.24497e-9   -1.05927e-9
 0.00262733   -0.00154653  -2.5449e-6   -9.26404e-7  -5.59744e-7     -1.77222e-9   -1.50051e-9   -1.27544e-9   -1.08984e-9
 0.00262836   -0.00155286  -2.61287e-6  -9.2634e-7   -5.53958e-7     -1.81464e-9   -1.53633e-9   -1.30501e-9   -1.11009e-9
 0.00262945   -0.00155962  -2.68853e-6  -9.2653e-7   -5.4813e-7   …  -1.85842e-9   -1.57349e-9   -1.33751e-9   -1.14312e-9
 0.00263062   -0.0015668   -2.77253e-6  -9.27023e-7  -5.42324e-7     -1.90358e-9   -1.61161e-9   -1.3689e-9    -1.16419e-9
 0.00263186   -0.0015744   -2.8656e-6   -9.27873e-7  -5.36604e-7     -1.9502e-9    -1.65119e-9   -1.40359e-9   -1.19983e-9
 0.00263318   -0.00158241  -2.96855e-6  -9.29135e-7  -5.31035e-7     -1.9983e-9    -1.69178e-9   -1.43696e-9   -1.22184e-9
 0.00263456   -0.00159082  -3.08227e-6  -9.30868e-7  -5.2568e-7      -2.04798e-9   -1.73397e-9   -1.47399e-9   -1.26022e-9
 0.00263602   -0.00159963  -3.20774e-6  -9.33129e-7  -5.20602e-7  …  -2.09926e-9   -1.77724e-9   -1.5095e-9    -1.2833e-9
 0.00263755   -0.00160883  -3.34604e-6  -9.35983e-7  -5.15862e-7     -2.15225e-9   -1.82225e-9   -1.54906e-9   -1.3246e-9
 0.00263916   -0.00161841  -3.49833e-6  -9.39492e-7  -5.11521e-7     -2.20696e-9   -1.86841e-9   -1.58689e-9   -1.34889e-9
 0.00264083   -0.00162837  -3.66591e-6  -9.43723e-7  -5.07635e-7     -2.26352e-9   -1.91645e-9   -1.62916e-9   -1.39328e-9
 0.00264258   -0.0016387   -3.8502e-6   -9.48744e-7  -5.04261e-7     -2.32195e-9   -1.96574e-9   -1.66951e-9   -1.41893e-9
 0.0026444    -0.00164938  -4.05273e-6  -9.54626e-7  -5.01451e-7  …  -2.38238e-9   -2.01707e-9   -1.71472e-9   -1.46662e-9
 ⋮                                                                ⋱                               ⋮
 0.000860346  -4.01324e-6  -1.36644e-7  -7.31899e-8  -4.28883e-8     -1.39508e-10  -1.18227e-10  -1.01283e-10  -9.09899e-11
 0.00085939   -3.88449e-6  -1.37539e-7  -7.4507e-8   -4.42768e-8     -1.37805e-10  -1.16606e-10  -9.83224e-11  -7.94067e-11
 0.000858475  -3.76274e-6  -1.3842e-7   -7.58188e-8  -4.56892e-8     -1.36152e-10  -1.15378e-10  -9.87948e-11  -8.84856e-11
 0.0008576    -3.64779e-6  -1.39283e-7  -7.71206e-8  -4.71193e-8  …  -1.34502e-10  -1.13817e-10  -9.60188e-11  -7.78246e-11
 0.000856764  -3.53943e-6  -1.40128e-7  -7.84072e-8  -4.85601e-8     -1.32899e-10  -1.12616e-10  -9.63807e-11  -8.60456e-11
 0.000855968  -3.43746e-6  -1.4095e-7   -7.96739e-8  -5.00047e-8     -1.313e-10    -1.11113e-10  -9.37873e-11  -7.63026e-11
 0.000855212  -3.34169e-6  -1.41749e-7  -8.09157e-8  -5.14454e-8     -1.29745e-10  -1.09937e-10  -9.40377e-11  -8.36676e-11
 0.000854496  -3.25196e-6  -1.4252e-7   -8.21274e-8  -5.28746e-8     -1.28194e-10  -1.0849e-10   -9.16252e-11  -7.48387e-11
 0.00085382   -3.16809e-6  -1.43262e-7  -8.33043e-8  -5.42843e-8  …  -1.26685e-10  -1.07339e-10  -9.17635e-11  -8.13491e-11
 0.000853184  -3.08993e-6  -1.43973e-7  -8.44414e-8  -5.56663e-8     -1.25182e-10  -1.05947e-10  -8.953e-11    -7.34309e-11
 0.000852587  -3.01735e-6  -1.44651e-7  -8.55341e-8  -5.70124e-8     -1.23717e-10  -1.04818e-10  -8.95553e-11  -7.90881e-11
 0.000852031  -2.95019e-6  -1.45293e-7  -8.65775e-8  -5.83145e-8     -1.2226e-10   -1.0348e-10   -8.74995e-11  -7.20772e-11
 0.000851514  -2.88835e-6  -1.45898e-7  -8.75673e-8  -5.95643e-8     -1.20838e-10  -1.02373e-10  -8.7411e-11   -7.68823e-11
 0.000851037  -2.8317e-6   -1.46464e-7  -8.8499e-8   -6.07539e-8  …  -1.19425e-10  -1.01087e-10  -8.55314e-11  -7.0776e-11
 0.0008506    -2.78014e-6  -1.46989e-7  -8.93688e-8  -6.18755e-8     -1.18052e-10  -9.99998e-11  -8.53283e-11  -7.47297e-11
 0.000850202  -2.73357e-6  -1.47471e-7  -9.01726e-8  -6.29217e-8     -1.16767e-10  -9.87761e-11  -8.36245e-11  -6.95254e-11
 0.000849844  -2.6919e-6   -1.4791e-7   -9.09068e-8  -6.38853e-8     -1.16171e-10  -9.78546e-11  -8.33283e-11  -7.26309e-11
 0.000849526  -2.65506e-6  -1.48303e-7  -9.15682e-8  -6.47598e-8     -1.19867e-10  -9.80994e-11  -8.21291e-11  -6.83873e-11
 0.000849248  -2.62298e-6  -1.48649e-7  -9.21537e-8  -6.55392e-8  …  -1.44725e-10  -1.07284e-10  -8.51327e-11  -7.16104e-11
 0.00084901   -2.59559e-6  -1.48948e-7  -9.26608e-8  -6.62178e-8     -2.48154e-10  -1.59995e-10  -1.08585e-10  -7.82972e-11
 0.000848811  -2.57284e-6  -1.49199e-7  -9.30869e-8  -6.67909e-8     -5.67241e-10  -3.66004e-10  -2.322e-10    -1.48171e-10
 0.000848652  -2.5547e-6   -1.494e-7    -9.34302e-8  -6.72545e-8     -1.30662e-9   -9.4078e-10   -6.57973e-10  -4.46048e-10
 0.000848533  -2.54112e-6  -1.49552e-7  -9.36891e-8  -6.76052e-8     -2.57098e-9   -2.07407e-9   -1.64632e-9   -1.28368e-9
 0.000848453  -2.53208e-6  -1.49653e-7  -9.38624e-8  -6.78404e-8  …  -4.08749e-9   -3.57702e-9   -3.11482e-9   -2.69659e-9
 0.000848413  -2.52757e-6  -1.49704e-7  -9.39492e-8  -6.79584e-8     -5.16548e-9   -4.71124e-9   -4.30053e-9   -3.92791e-9
```

```jldoctest ex
# dropping the middle peaks
res[620:1100, :] .= 0
# and smoothing the remaining peaks
res[:, 10:end] .= 0
freqs = ContinuousWavelets.getMeanFreq(f, c)
p2 = heatmap(1:n, freqs, abs.(res)', xlabel = "time (ms)", ylabel = "Frequency (Hz)", colorbar = false, c = :viridis)
dropped = ContinuousWavelets.icwt(res, c, DualFrames())

# output

┌ Warning: the canonical dual frame is off by 3.8053445963886525e6, consider using one of the delta dual frames
└ @ ContinuousWavelets ~/allHail/projects/ContinuousWavelets/src/sanityChecks.jl:37
2047-element Vector{Float64}:
  0.021353468263494175
  0.021355106707309952
  0.021358383142385133
  0.0213632966799539
  0.021369846027086553
  0.02137802953320333
  0.021387845249242986
  0.021399290997235258
  0.021412364447637153
  0.021427063201564893
  0.021443384874913773
  0.021461327181383348
  0.02148088801153371
  0.02150206550525926
  0.021524858115380973
  0.02154926466049354
  0.02157528436564928
  0.02160291688997034
  0.02163216234077386
  0.021663021274288985
  0.021695494683482835
  0.021729583973922578
  0.021765290928916468
  0.02180261766545532
  0.02184156658263429
  0.021882140304357523
  ⋮
 -0.006165853433748903
 -0.006164176592416354
 -0.00616257034930849
 -0.006161035189332783
 -0.006159571506740685
 -0.006158179602286722
 -0.006156859681573191
 -0.0061556118547751075
 -0.006154436137925803
 -0.0061533324558952045
 -0.006152300647156452
 -0.006151340470370551
 -0.0061504516127756205
 -0.006149633700272786
 -0.006148886309059823
 -0.006148208978576426
 -0.006147601225469837
 -0.006147062558231826
 -0.006146592492113732
 -0.006146190563893243
 -0.006145856346051334
 -0.006145589459921974
 -0.006145389587395019
 -0.006145256480782908
 -0.006145189970537515
```

```jldoctest ex; output=false
p1 = plot(f, legend=false, title="Smoothing and dropping bumps", linewidth=2)
plot!(dropped, linewidth=3)
l = @layout [a{0.3h}; b{0.7h}]
plot(p1, p2, layout=l)

# output

Plot{Plots.GRBackend() n=3}
```

![Bumps](/docs/bumps.svg)

It can also handle collections of examples at the same time, should you need to do a batch of transforms:

```jldoctest ex
julia> exs = cat(testfunction(n, "Doppler"), testfunction(n, "Blocks"), testfunction(n, "Bumps"), testfunction(n, "HeaviSine"), dims=2);

julia> c = wavelet(cDb2, β=2, extraOctaves=-0)


julia> res = circshift(ContinuousWavelets.cwt(exs, c), (0, 1, 0))
┌ Warning: the highest frequency wavelet has more than 1% its max at the end, so it may not be analytic. Think carefully
│   highAprxAnalyt = 0.2677814440444114
└ @ ContinuousWavelets ~/allHail/projects/ContinuousWavelets/src/sanityChecks.jl:10
2047×32×4 Array{Float64, 3}:
[:, :, 1] =
  1.89367e-5   0.000266033  0.000196408  2.69195e-5  -3.89652e-5   …   0.000121129   9.23682e-5    4.6727e-5     2.99983e-6
  8.33321e-5   0.000266913  0.000201712  3.29627e-5  -2.66883e-5      -1.90633e-5    3.35839e-7    1.56557e-5   -4.46419e-5
 -0.000103328  0.000267843  0.000207148  3.99906e-5  -1.42476e-5      -0.000169306  -0.000138073  -8.95268e-5   -0.000218151
 -0.000354648  0.000268836  0.000212775  4.76928e-5  -2.62643e-6      -0.000225955  -0.000244553  -0.000251492  -0.000256004
 -0.000189096  0.000269891  0.000218496  5.59397e-5   8.68511e-6      -8.89207e-5   -0.000139912  -0.000206374   5.48004e-5
  0.000341582  0.000270994  0.000224054  6.40344e-5   1.92346e-5   …   0.000160383   0.000155859   0.000132569   0.000428554
  0.000574352  0.000272142  0.000229273  7.05717e-5   2.64068e-5       0.000274473   0.000342921   0.000418284   0.000352239
  0.000103119  0.000273352  0.000234229  7.43258e-5   2.73536e-5       9.54274e-5    0.000158369   0.000244307  -0.000205831
 -0.000603783  0.000274651  0.000239099  7.51774e-5   2.16395e-5      -0.000232655  -0.000259222  -0.000284486  -0.000639977
 -0.000707411  0.000276047  0.000243868  7.40268e-5   1.14304e-5      -0.000360063  -0.000455264  -0.000581431  -0.000390285
 -3.14536e-6   0.00027753   0.000248296  7.16438e-5  -6.91484e-7   …  -0.000102476  -0.000158943  -0.000244447   0.000360305
  0.00080309   0.000279084  0.00025213   6.7744e-5   -1.34135e-5       0.000321925   0.000376303   0.000436438   0.000830792
  0.000846225  0.000280713  0.000255353  6.14582e-5  -2.61966e-5       0.000477263   0.000592555   0.000745339   0.000475446
  2.03648e-5   0.000282445  0.000258218  5.27814e-5  -3.78174e-5       0.000154397   0.000209076   0.000301702  -0.000419728
 -0.000906078  0.000284314  0.000261092  4.33701e-5  -4.60488e-5      -0.000383612  -0.000453911  -0.000515709  -0.00100263
 -0.00104613   0.000286343  0.000264233  3.55783e-5  -4.8898e-5    …  -0.000625456  -0.000759941  -0.000923217  -0.000684463
 -0.000232578  0.00028853   0.000267642  3.06018e-5  -4.60131e-5      -0.000297449  -0.000369253  -0.00049071    0.000298626
  0.000844351  0.000290849  0.000271064  2.7632e-5   -3.88691e-5       0.000357941   0.00042059    0.00044362    0.00110146
  0.00126426   0.000293265  0.000274163  2.4805e-5   -2.9795e-5        0.000777024   0.00092552    0.00107363    0.00101936
  0.000661064  0.000295755  0.000276749  2.09797e-5  -2.07221e-5       0.000564997   0.000675524   0.000833826   8.40955e-5
 -0.000500549  0.000298324  0.000278916  1.6721e-5   -1.23748e-5   …  -0.000155102  -0.000174778  -0.000121381  -0.000979198
 -0.00132705   0.000300994  0.000280977  1.37535e-5  -4.32645e-6      -0.000829855  -0.000967024  -0.00105249   -0.00134558
 -0.00119555   0.000303781  0.000283184  1.34997e-5   4.07627e-6      -0.000914617  -0.00106698   -0.00123078   -0.000723546
 -0.000196704  0.00030667   0.000285456  1.59517e-5   1.25343e-5      -0.000301041  -0.000358611  -0.000495476   0.000451275
  0.000969924  0.000309617  0.000287365  1.97024e-5   1.94256e-5       0.000596571   0.000672194   0.000643417   0.00135921
  0.00151249   0.00031257   0.000288434  2.30008e-5   2.26662e-5   …   0.00114368    0.00129899    0.00139181    0.00138047
  ⋮                                                                ⋱                               ⋮
 -2.3429e-5    0.00214164   0.00162423   0.00112806   0.00069026       1.56529e-6   -2.54222e-6    1.50798e-6    6.0523e-7
 -2.20522e-5   0.00213524   0.00160902   0.0011248    0.00068888       1.58741e-6   -2.3358e-6     1.47246e-6    6.11727e-7
 -2.07021e-5   0.00212882   0.00159371   0.00112145   0.000687397      1.61019e-6   -2.13201e-6    1.43897e-6    6.19306e-7
 -1.93791e-5   0.00212236   0.00157832   0.001118     0.000685813  …   1.6338e-6    -1.93077e-6    1.40766e-6    6.28085e-7
 -1.80838e-5   0.00211588   0.00156282   0.00111445   0.000684127      1.65842e-6   -1.732e-6      1.37869e-6    6.38206e-7
 -1.68167e-5   0.00210936   0.00154724   0.0011108    0.000682338      1.6843e-6    -1.53556e-6    1.35228e-6    6.49838e-7
 -1.55784e-5   0.00210281   0.00153156   0.00110706   0.000680445      1.71173e-6   -1.34128e-6    1.32864e-6    6.63186e-7
 -1.43693e-5   0.00209623   0.00151579   0.00110321   0.000678449      1.74107e-6   -1.14894e-6    1.30808e-6    6.78502e-7
 -1.319e-5     0.00208962   0.00149993   0.00109927   0.000676349  …   1.77281e-6   -9.58253e-7    1.29095e-6    6.96095e-7
 -1.20412e-5   0.00208298   0.00148398   0.00109523   0.000674145      1.80757e-6   -7.68815e-7    1.27767e-6    7.16359e-7
 -1.09234e-5   0.00207632   0.00146794   0.00109109   0.000671837      1.84615e-6   -5.8009e-7     1.2688e-6     7.398e-7
 -9.83707e-6   0.00206962   0.00145181   0.00108686   0.000669424      1.88968e-6   -3.91334e-7    1.26505e-6    7.67079e-7
 -8.78284e-6   0.00206289   0.0014356    0.00108252   0.000666906      1.93977e-6   -2.01488e-7    1.26737e-6    7.99097e-7
 -7.76109e-6   0.00205614   0.00141929   0.00107809   0.000664284  …   1.99884e-6   -8.98877e-9    1.27704e-6    8.37109e-7
 -6.77201e-6   0.00204935   0.0014029    0.00107356   0.000661557      2.07152e-6    1.88617e-7    1.29594e-6    8.82963e-7
 -5.8154e-6    0.00204254   0.00138642   0.00106893   0.000658725      2.18187e-6    3.96221e-7    1.3269e-6     9.39559e-7
 -4.89024e-6   0.0020357    0.00136985   0.00106421   0.000655789      2.36209e-6    6.41261e-7    1.37549e-6    1.01282e-6
 -3.99268e-6   0.00202884   0.0013532    0.00105939   0.000652748      2.63171e-6    9.60498e-7    1.47322e-6    1.13924e-6
 -3.08658e-6   0.00202194   0.00133647   0.00105447   0.000649604  …   3.00328e-6    1.37656e-6    1.66221e-6    1.36753e-6
 -2.1235e-6    0.00201502   0.00131965   0.00104945   0.000646355      3.48171e-6    1.90218e-6    1.96868e-6    1.72503e-6
 -1.08074e-6   0.00200808   0.00130275   0.00104434   0.000643004      4.06464e-6    2.53947e-6    2.40611e-6    2.2242e-6
  4.79044e-8   0.00200111   0.00128576   0.00103914   0.000639549      4.7377e-6     3.28078e-6    2.97486e-6    2.86052e-6
  1.248e-6     0.00199411   0.0012687    0.00103384   0.000635993      5.35474e-6    4.03275e-6    3.66092e-6    3.49912e-6
  2.24677e-6   0.00198709   0.00125155   0.00102844   0.000632336  …   5.66737e-6    4.55137e-6    4.24042e-6    3.80685e-6
  2.63848e-6   0.00198004   0.00123433   0.00102295   0.000628578      5.49586e-6    4.58582e-6    4.3791e-6     3.47575e-6

[:, :, 2] =
  7.81007e-18  0.0226754  0.00955729  0.00470372    0.00341201   …   3.57962e-18   9.32869e-18   3.03725e-18   3.68809e-18
 -3.47114e-18  0.022684   0.00950443  0.00469405    0.00345558      -8.67785e-19   1.73557e-18  -1.73557e-18  -3.47114e-18
 -8.8948e-18   0.0226929  0.00944925  0.00468509    0.00349665      -4.33893e-18  -8.67785e-19  -9.11175e-18  -5.64061e-18
 -3.90503e-18  0.0227021  0.00939273  0.0046771     0.00353795      -2.60336e-18  -4.33893e-18  -7.81007e-18   1.73557e-18
  5.20671e-18  0.0227115  0.00933463  0.00466972    0.00358021      -2.16946e-18   1.30168e-18  -4.77282e-18   6.72534e-18
  1.08473e-17  0.0227211  0.00927531  0.00466315    0.00362167   …   1.73557e-18   2.60336e-18   5.20671e-18   4.33893e-18
  1.73557e-18  0.0227308  0.00921533  0.00465729    0.00366155      -1.84404e-18   3.68809e-18  -2.16946e-19  -1.54574e-18
 -4.33893e-18  0.0227406  0.0091542   0.00464097    0.00369962      -2.38641e-18   2.16946e-18  -4.12198e-18  -9.11175e-18
 -6.0745e-18   0.0227506  0.00909149  0.00461836    0.00373611      -6.29144e-18  -2.16946e-18  -6.94228e-18  -3.47114e-18
  1.73557e-18  0.0227606  0.0090268   0.00459309    0.00377021      -3.03725e-18   4.33893e-18  -1.95252e-18   1.51862e-18
  6.94228e-18  0.0227715  0.00896175  0.0045651     0.00380156   …   6.50839e-19   6.50839e-18   8.67785e-19   7.37618e-18
  8.67785e-18  0.0227816  0.00889506  0.00453598    0.00382945       4.98977e-18   1.16066e-17   5.20671e-18   5.42366e-18
  7.81007e-18  0.0227908  0.00882594  0.00450528    0.00385382       5.20671e-18   1.10643e-17   5.20671e-18   3.90503e-18
  4.77282e-18  0.0227994  0.00875483  0.00447282    0.00387516       5.42366e-18   9.43717e-18   4.98977e-18   2.8203e-18
  1.04134e-17  0.0228079  0.00868247  0.00443756    0.00389349       5.42366e-18   9.54564e-18   3.90503e-18   3.79656e-18
  7.81007e-18  0.022816   0.00860816  0.00440952    0.00391034   …   2.92878e-18   5.42366e-18   5.20671e-18   2.49488e-18
  5.20671e-18  0.0228237  0.00853199  0.00439263    0.00392982       1.51862e-18   6.39992e-18   8.94904e-19  -1.41015e-18
  8.67785e-19  0.0228314  0.00845451  0.0043823     0.00395304      -9.76259e-19   3.14572e-18  -4.06774e-18  -4.42028e-18
  4.33893e-18  0.022839   0.00837553  0.00437615    0.00397836      -3.06437e-18   2.16946e-18  -4.17622e-18  -4.17622e-18
 -4.33893e-19  0.0228464  0.00829515  0.00437519    0.00400443      -3.74232e-18   2.00675e-18  -4.85417e-18  -4.88129e-19
  1.73557e-18  0.0228534  0.00821333  0.0043745     0.00403084   …  -2.60336e-18   6.29144e-18  -6.50839e-19  -8.67785e-19
  0.0          0.0228598  0.00813032  0.00437647    0.00405811      -2.92878e-18   2.2237e-18   -1.19321e-18   1.41015e-18
  2.60336e-18  0.0228662  0.00804722  0.00438184    0.00408473      -1.08473e-18   4.33893e-18  -6.50839e-19  -2.60336e-18
  1.95252e-18  0.0228723  0.0079635   0.00439047    0.00411055      -8.67785e-19   5.85755e-18  -1.51862e-18  -8.67785e-19
  5.20671e-18  0.0228782  0.00787891  0.00440032    0.00413726      -1.73557e-18   7.15923e-18  -2.16946e-19   1.30168e-18
  6.50839e-18  0.0228838  0.00779326  0.00441358    0.00416548   …   7.59312e-19   6.39992e-18   1.30168e-18   1.19321e-18
  ⋮                                                              ⋱                               ⋮
 -1.44095e-17  0.0325833  0.011895    6.85933e-5   -1.59365e-17     -2.70919e-18  -5.81629e-18  -5.21943e-18  -1.60223e-18
  3.16205e-18  0.0326565  0.011825    8.02981e-5   -6.65451e-18      1.16938e-18   1.53765e-18   2.73932e-18   7.95815e-19
 -5.48443e-18  0.0327291  0.0117574   9.28584e-5   -8.71413e-18      2.67161e-18   1.28696e-18   4.52609e-18   2.08238e-18
 -4.34389e-18  0.0328013  0.0116917   0.000106668  -1.21196e-17  …   1.48097e-18   1.92899e-18   6.464e-18    -1.28561e-18
 -9.8856e-18   0.0328729  0.0116282   0.000121534  -1.37219e-17      1.22177e-18  -2.2563e-18   -1.04807e-18  -5.17493e-18
 -9.75208e-18  0.0329441  0.0115671   0.000137688  -9.63253e-18      6.24423e-19  -5.08245e-18  -2.92404e-18  -4.64797e-18
 -1.42635e-17  0.0330148  0.0115085   0.00015502   -1.14764e-17      2.21111e-19  -4.69172e-18  -2.81824e-18  -5.07725e-18
 -9.10037e-18  0.033085   0.0114518   0.000172867  -3.32289e-18     -6.5851e-18   -7.25168e-18  -2.24932e-18  -7.02497e-18
 -9.99162e-18  0.0331548  0.0113973   0.000191289  -1.14548e-17  …  -3.14409e-18  -8.03053e-18  -4.41385e-18  -8.68148e-18
 -1.51224e-17  0.0332242  0.0113446   0.000209743  -5.77727e-18     -4.43829e-18  -8.09614e-18  -1.049e-17    -9.3004e-18
 -8.27538e-18  0.033293   0.0112944   0.000228457  -1.40531e-17      8.34998e-19  -3.2349e-18   -3.45378e-19  -1.38855e-18
 -9.93491e-19  0.0333612  0.0112469   0.000247547  -6.87407e-18      5.33837e-18   1.50555e-18   4.36914e-18   7.40897e-18
  8.21582e-18  0.0334288  0.0112018   0.000267277  -1.2538e-17       1.14529e-17   6.8988e-18    1.18153e-17   7.95234e-18
  7.74301e-18  0.0334962  0.0111581   0.000287568  -4.71295e-18  …   1.03412e-17   6.1477e-18    1.05553e-17   2.83156e-18
 -6.63581e-18  0.0335632  0.0111158   0.000308519  -1.62521e-17      5.2434e-18    2.10451e-19   1.53726e-18  -7.63147e-18
 -1.2945e-17   0.0336298  0.0110753   0.00033007   -1.06388e-18      1.2352e-18   -5.37709e-18  -4.7038e-18   -9.85684e-18
 -1.16366e-17  0.0336961  0.0110364   0.000352368  -1.47154e-17     -3.58179e-18  -1.07746e-17  -1.02248e-17  -6.74285e-18
 -2.55726e-18  0.033762   0.0109992   0.000375385  -1.35714e-18     -4.72663e-19  -6.52154e-18  -3.90631e-18  -4.61867e-18
 -7.6293e-18   0.0338274  0.010964    0.000399294  -1.25056e-17  …  -2.32007e-18  -6.17772e-18  -2.21136e-18  -5.25095e-18
 -4.66963e-18  0.0338924  0.0109308   0.000424023  -8.39451e-18      3.2299e-18   -1.83791e-18   6.90007e-19  -4.72535e-18
 -3.30708e-18  0.033957   0.0108995   0.000449495  -1.65074e-17      2.13675e-18  -3.22622e-18   4.58688e-19  -7.19358e-18
 -7.6997e-18   0.0340217  0.0108677   0.000475705  -6.89573e-18      1.24614e-18  -4.3671e-18   -3.49203e-18  -6.23824e-18
 -1.03499e-17  0.0340864  0.0108359   0.000502628  -1.43084e-17      4.5178e-18   -1.82058e-18   9.12161e-19  -5.50979e-18
 -9.29595e-18  0.0341512  0.0108039   0.00053027   -1.27059e-17  …   8.83625e-19  -6.65106e-18  -3.40533e-18  -3.84208e-19
  1.27592e-18  0.0342157  0.0107729   0.000558637  -1.03715e-17      4.50903e-18  -1.1533e-18    4.21959e-18  -1.7043e-18

[:, :, 3] =
 -4.2736e-7   0.0059687   0.00256803  0.000892506  0.000666694  …  3.97814e-8    2.49033e-8   -3.38814e-8  4.47839e-8  1.86209e-8
 -4.39691e-7  0.00596762  0.00256378  0.000882834  0.000692389     2.76986e-8    1.21816e-8   -4.59854e-8  3.30771e-8  7.78201e-9
 -4.48084e-7  0.0059668   0.00256     0.000874593  0.000716669     1.61823e-8    7.4973e-10   -5.67431e-8  2.24685e-8  2.3172e-9
 -4.51634e-7  0.00596629  0.00255675  0.000868429  0.000739482     7.56909e-9   -6.89343e-9   -6.29884e-8  1.71253e-8  2.13432e-9
 -4.53736e-7  0.00596616  0.00255388  0.00086509   0.000761802     3.629e-9     -9.79742e-9   -6.45768e-8  1.66027e-8  3.47374e-9
 -4.5679e-7   0.00596647  0.00255141  0.000865675  0.00078427   …  3.56186e-9   -9.58071e-9   -6.39968e-8  1.76824e-8  4.08017e-9
 -4.6046e-7   0.0059673   0.00254963  0.000872086  0.000806868     4.59725e-9   -8.70368e-9   -6.31675e-8  1.84952e-8  4.09172e-9
 -4.64139e-7  0.00596883  0.0025489   0.000881343  0.000829423     5.69239e-9   -8.10867e-9   -6.30668e-8  1.88061e-8  4.06813e-9
 -4.67881e-7  0.00597128  0.00254952  0.000890693  0.000851916     6.29758e-9   -8.02414e-9   -6.36202e-8  1.89465e-8  4.11435e-9
 -4.71676e-7  0.00597491  0.00255138  0.000899523  0.000874303     6.36966e-9   -8.09838e-9   -6.41474e-8  1.91417e-8  4.16722e-9
 -4.75528e-7  0.00597956  0.00255393  0.000907839  0.000896166  …  6.40462e-9   -8.15394e-9   -6.46504e-8  1.9321e-8   4.22135e-9
 -4.79437e-7  0.00598479  0.0025567   0.000916817  0.000917284     6.49437e-9   -8.20927e-9   -6.51588e-8  1.95034e-8  4.27677e-9
 -4.83404e-7  0.00599012  0.00255927  0.000927782  0.000937765     6.58798e-9   -8.26478e-9   -6.56743e-8  1.96892e-8  4.33352e-9
 -4.8743e-7   0.00599535  0.00256136  0.000941771  0.000957486     6.68451e-9   -8.32068e-9   -6.61969e-8  1.98784e-8  4.39166e-9
 -4.91517e-7  0.00600043  0.00256292  0.000960158  0.000976051     6.78356e-9   -8.37697e-9   -6.67268e-8  2.0071e-8   4.45123e-9
 -4.95667e-7  0.00600533  0.00256398  0.000983923  0.000993793  …  6.88522e-9   -8.43364e-9   -6.72642e-8  2.02673e-8  4.51227e-9
 -4.99881e-7  0.00601001  0.00256442  0.00101043   0.00101244      6.98959e-9   -8.49068e-9   -6.78092e-8  2.04672e-8  4.57485e-9
 -5.04161e-7  0.00601461  0.00256432  0.00103744   0.00103152      7.09676e-9   -8.54808e-9   -6.83619e-8  2.0671e-8   4.63901e-9
 -5.08507e-7  0.00601912  0.00256353  0.00106395   0.00105097      7.20684e-9   -8.60584e-9   -6.89226e-8  2.08787e-8  4.7048e-9
 -5.12922e-7  0.00602346  0.00256192  0.00108944   0.00107021      7.31992e-9   -8.66394e-9   -6.94914e-8  2.10904e-8  4.7723e-9
 -5.17408e-7  0.00602767  0.00255944  0.0011127    0.00108951   …  7.43612e-9   -8.72238e-9   -7.00685e-8  2.13063e-8  4.84155e-9
 -5.21965e-7  0.00603174  0.00255602  0.0011349    0.0011089       7.55556e-9   -8.78114e-9   -7.06541e-8  2.15265e-8  4.91261e-9
 -5.26596e-7  0.00603581  0.00255205  0.00115543   0.00112757      7.67835e-9   -8.84021e-9   -7.12483e-8  2.17511e-8  4.98557e-9
 -5.31304e-7  0.00603995  0.00254764  0.00117301   0.00114543      7.80462e-9   -8.89957e-9   -7.18513e-8  2.19802e-8  5.06047e-9
 -5.36088e-7  0.00604422  0.00254282  0.00118725   0.0011627       7.93451e-9   -8.95921e-9   -7.24635e-8  2.2214e-8   5.1374e-9
 -5.40953e-7  0.00604861  0.00253753  0.00120025   0.00118002   …  8.06815e-9   -9.0191e-9    -7.30848e-8  2.24527e-8  5.21643e-9
  ⋮                                                             ⋱                                          ⋮
 -1.09949e-7  0.00323445  0.00179022  9.75688e-5   3.74422e-7      1.08205e-9   -1.10682e-9   -1.5155e-8   4.19418e-9  6.89612e-10
 -1.09366e-7  0.00324122  0.00178661  0.000100633  3.77359e-7      1.07502e-9   -1.10338e-9   -1.50754e-8  4.17118e-9  6.85435e-10
 -1.08787e-7  0.00324787  0.00178368  0.000103634  3.80362e-7      1.06806e-9   -1.09994e-9   -1.49964e-8  4.14838e-9  6.813e-10
 -1.08213e-7  0.00325462  0.00178051  0.000106763  3.83431e-7   …  1.06117e-9   -1.09651e-9   -1.49181e-8  4.12579e-9  6.77207e-10
 -1.07644e-7  0.00326155  0.00177673  0.00011008   3.86569e-7      1.05436e-9   -1.09308e-9   -1.48405e-8  4.1034e-9   6.73155e-10
 -1.0708e-7   0.00326855  0.00177252  0.000113701  3.89779e-7      1.04762e-9   -1.08966e-9   -1.47635e-8  4.0812e-9   6.69143e-10
 -1.06521e-7  0.00327561  0.00176795  0.000117616  3.93062e-7      1.04095e-9   -1.08624e-9   -1.46871e-8  4.0592e-9   6.6517e-10
 -1.05966e-7  0.00328275  0.00176295  0.000121523  3.96422e-7      1.03435e-9   -1.08282e-9   -1.46114e-8  4.03739e-9  6.61238e-10
 -1.05416e-7  0.00328999  0.0017575   0.000125148  3.99861e-7   …  1.02782e-9   -1.07941e-9   -1.45363e-8  4.01577e-9  6.57343e-10
 -1.0487e-7   0.00329732  0.00175147  0.000128298  4.03381e-7      1.02136e-9   -1.07601e-9   -1.44618e-8  3.99434e-9  6.53487e-10
 -1.04329e-7  0.00330481  0.00174472  0.000131242  4.06987e-7      1.01497e-9   -1.0726e-9    -1.43879e-8  3.97309e-9  6.49669e-10
 -1.03793e-7  0.0033124   0.00173742  0.000134067  4.10681e-7      1.00864e-9   -1.06921e-9   -1.43146e-8  3.95203e-9  6.45888e-10
 -1.03261e-7  0.0033201   0.00172957  0.000136915  4.14466e-7      1.00238e-9   -1.06582e-9   -1.42419e-8  3.93114e-9  6.42143e-10
 -1.02733e-7  0.00332784  0.00172136  0.000139827  4.18346e-7   …  9.97492e-10  -1.06244e-9   -1.41698e-8  3.91044e-9  6.38434e-10
 -1.02209e-7  0.00333554  0.00171322  0.000142776  4.22324e-7      1.03149e-9   -1.05763e-9   -1.40983e-8  3.88991e-9  6.34761e-10
 -1.0169e-7   0.00334314  0.00170537  0.000145656  4.26405e-7      1.15792e-9   -1.01048e-9   -1.40257e-8  3.86955e-9  6.31123e-10
 -1.01175e-7  0.00335065  0.00169783  0.000148564  4.30591e-7      1.40432e-9   -8.62501e-10  -1.39044e-8  3.85114e-9  6.29523e-10
 -1.00662e-7  0.00335806  0.00169074  0.000151598  4.34888e-7      1.79613e-9   -5.78987e-10  -1.36661e-8  3.88963e-9  6.9526e-10
 -1.00081e-7  0.00336532  0.00168432  0.000154811  4.39299e-7   …  2.35374e-9   -1.32135e-10  -1.32681e-8  4.06365e-9  9.21894e-10
 -9.93313e-8  0.00337236  0.00167881  0.000158131  4.43829e-7      3.09208e-9    5.0037e-10   -1.26779e-8  4.42412e-9  1.36627e-9
 -9.83556e-8  0.00337911  0.00167463  0.000161542  4.48484e-7      4.03282e-9    1.34162e-9   -1.18702e-8  5.00834e-9  2.07275e-9
 -9.71063e-8  0.00338574  0.00167092  0.000165053  4.53267e-7      5.19836e-9    2.41717e-9   -1.08147e-8  5.84663e-9  3.0828e-9
 -9.55338e-8  0.00339243  0.00166694  0.000168694  4.58184e-7      6.30957e-9    3.49447e-9   -9.63413e-9  6.97634e-9  4.19423e-9
 -9.41123e-8  0.00339924  0.00166237  0.000172551  4.6324e-7    …  6.92345e-9    4.12867e-9   -8.75924e-9  8.01012e-9  4.78652e-9
 -9.36079e-8  0.0034061   0.00165751  0.000176759  4.68442e-7      6.79732e-9    3.9998e-9    -8.6509e-9   8.3188e-9   4.24252e-9

[:, :, 4] =
  0.000307454  -0.0150898   -0.00391724   0.0165289    0.0145612   …   0.000601507   0.000528795   0.000541871   0.000301757
  6.05948e-5   -0.0152536   -0.00405883   0.0162813    0.0143339       0.000347251   0.000286288   0.000307363   8.45503e-5
 -0.000106628  -0.0154172   -0.00420221   0.0160291    0.0141005       0.000118658   7.07121e-5    9.46531e-5   -2.5274e-5
 -0.000176071  -0.0155806   -0.00434733   0.0157728    0.0138617      -3.4245e-5    -5.45697e-5   -1.28804e-5   -2.95235e-5
 -0.000215585  -0.0157438   -0.00449399   0.0155126    0.0136178      -9.24075e-5   -8.66309e-5   -2.40997e-5   -3.35174e-6
 -0.000273117  -0.0159068   -0.00464219   0.0152487    0.0133693   …  -8.81642e-5   -7.52024e-5   -3.33285e-6    8.1492e-6
 -0.000341921  -0.0160696   -0.00479189   0.0149812    0.0131165      -7.06997e-5   -5.86549e-5    1.20476e-5    7.73542e-6
 -0.000409873  -0.0162322   -0.00494306   0.0147104    0.0128598      -5.88572e-5   -5.65403e-5    1.73367e-5    6.59563e-6
 -0.000477985  -0.0163945   -0.00509565   0.0144364    0.0125994      -5.72081e-5   -6.73706e-5    1.91596e-5    6.82771e-6
 -0.000546078  -0.0165567   -0.00524962   0.0141596    0.0123354      -5.87226e-5   -7.75426e-5    2.20147e-5    7.16823e-6
 -0.00061415   -0.0167185   -0.00540491   0.0138798    0.0120682   …  -5.98534e-5   -8.70935e-5    2.44877e-5    7.50848e-6
 -0.0006822    -0.0168801   -0.00556148   0.0135973    0.0117982      -6.09693e-5   -9.66139e-5    2.69597e-5    7.84844e-6
 -0.000750224  -0.0170415   -0.00571933   0.0133122    0.0115255      -6.20785e-5   -0.000106131   2.94308e-5    8.18811e-6
 -0.000818219  -0.0172026   -0.00587841   0.0130245    0.0112505      -6.31854e-5   -0.000115644   3.19007e-5    8.52747e-6
 -0.000886184  -0.0173634   -0.0060387    0.0127345    0.0109731      -6.42899e-5   -0.000125152   3.43694e-5    8.86651e-6
 -0.000954115  -0.017524    -0.00620019   0.0124423    0.0106935   …  -6.53919e-5   -0.000134656   3.68368e-5    9.20521e-6
 -0.00102201   -0.0176843   -0.00636282   0.0121481    0.0104118      -6.64916e-5   -0.000144154   3.93029e-5    9.54357e-6
 -0.00108987   -0.0178443   -0.00652655   0.011852     0.0101283      -6.75887e-5   -0.000153648   4.17674e-5    9.88157e-6
 -0.00115768   -0.0180041   -0.00669135   0.0115541    0.00984301     -6.86832e-5   -0.000163135   4.42304e-5    1.02192e-5
 -0.00122546   -0.0181636   -0.00685719   0.0112544    0.00955626     -6.97752e-5   -0.000172616   4.66917e-5    1.05564e-5
 -0.00129318   -0.0183229   -0.00702401   0.010953     0.00926822  …  -7.08645e-5   -0.000182091   4.91513e-5    1.08933e-5
 -0.00136086   -0.0184819   -0.00719178   0.0106499    0.00897913     -7.19512e-5   -0.000191559   5.1609e-5     1.12297e-5
 -0.00142848   -0.0186407   -0.00736048   0.0103453    0.00868921     -7.30352e-5   -0.00020102    5.40647e-5    1.15657e-5
 -0.00149606   -0.0187991   -0.00753011   0.0100391    0.00839864     -7.41164e-5   -0.000210473   5.65185e-5    1.19013e-5
 -0.00156357   -0.0189573   -0.00770065   0.00973159   0.00810764     -7.51948e-5   -0.000219918   5.897e-5      1.22364e-5
 -0.00163103   -0.0191152   -0.007872     0.00942276   0.00781636  …  -7.62704e-5   -0.000229355   6.14194e-5    1.25711e-5
  ⋮                                                                ⋱                               ⋮
  0.00176384   -0.00962016  -0.00347018  -0.0209142   -0.0179211      -1.98374e-5    0.000245626  -6.19494e-5   -4.47656e-6
  0.0016965    -0.00952832  -0.00340741  -0.0207956   -0.0178629      -2.10024e-5    0.000236204  -5.95005e-5   -4.13436e-6
  0.00162911   -0.00943669  -0.00334277  -0.0206722   -0.0177987      -2.21666e-5    0.000226773  -5.70494e-5   -3.79201e-6
  0.00156165   -0.00934527  -0.00327624  -0.0205439   -0.0177284   …  -2.33301e-5    0.000217334  -5.45961e-5   -3.44952e-6
  0.00149413   -0.00925404  -0.0032078   -0.0204106   -0.0176519      -2.44926e-5    0.000207887  -5.21408e-5   -3.10689e-6
  0.00142656   -0.00916302  -0.00313746  -0.0202724   -0.0175691      -2.56542e-5    0.000198431  -4.96835e-5   -2.76415e-6
  0.00135893   -0.0090722   -0.00306519  -0.0201291   -0.01748        -2.68148e-5    0.000188969  -4.72244e-5   -2.4213e-6
  0.00129125   -0.00898147  -0.00299143  -0.0199809   -0.0173845      -2.79745e-5    0.000179499  -4.47634e-5   -2.07836e-6
  0.00122352   -0.0088909   -0.00291597  -0.0198277   -0.0172826   …  -2.9133e-5     0.000170022  -4.23008e-5   -1.73534e-6
  0.00115575   -0.0088005   -0.00283878  -0.0196693   -0.0171741      -3.02905e-5    0.000160539  -3.98366e-5   -1.39226e-6
  0.00108793   -0.00871027  -0.00275981  -0.0195059   -0.0170591      -3.14469e-5    0.00015105   -3.73709e-5   -1.04913e-6
  0.00102008   -0.00862022  -0.00267909  -0.0193374   -0.0169375      -3.2602e-5     0.000141556  -3.49037e-5   -7.05954e-7
  0.00095218   -0.00853034  -0.00259653  -0.0191638   -0.0168092      -3.37559e-5    0.000132055  -3.24353e-5   -3.62753e-7
  0.000884248  -0.00844064  -0.00251214  -0.018985    -0.0166741   …  -3.49086e-5    0.00012255   -2.99656e-5   -1.95385e-8
  0.000816282  -0.00835112  -0.00242593  -0.0188011   -0.0165322      -3.62641e-5    0.000113041  -2.74948e-5    3.23677e-7
  0.000748286  -0.00826178  -0.00233792  -0.018612    -0.0163835      -4.36772e-5    0.000103297  -2.5023e-5     6.6688e-7
  0.000680261  -0.00817263  -0.00224811  -0.0184176   -0.0162279      -6.55108e-5    8.64965e-5   -2.28035e-5    7.23463e-7
  0.000611918  -0.00808368  -0.00215646  -0.018218    -0.0160653      -0.000106729   5.28847e-5   -2.86981e-5   -8.84735e-6
  0.00053323   -0.00799495  -0.0020629   -0.0180132   -0.0158957   …  -0.000171303  -3.66063e-6   -5.39545e-5   -4.14279e-5
  0.000429829  -0.00790643  -0.00196748  -0.0178031   -0.0157191      -0.000262417  -8.7768e-5    -0.000105853  -0.000105146
  0.000293499  -0.00781811  -0.00187021  -0.0175877   -0.0155353      -0.000383364  -0.000203043  -0.000189723  -0.000206338
  0.000117459  -0.00773001  -0.00177109  -0.017367    -0.0153443      -0.000537781  -0.000353818  -0.00030989   -0.000350925
 -0.000105351  -0.0076421   -0.0016701   -0.0171409   -0.0151462      -0.000692387  -0.000522514  -0.000471683  -0.000509964
 -0.000307094  -0.00755439  -0.00156729  -0.0169094   -0.0149407   …  -0.000783526  -0.000647484  -0.000619672  -0.000594673
 -0.000378125  -0.00746687  -0.00146262  -0.0166726   -0.0147279      -0.000765417  -0.000662793  -0.000663838  -0.00051676
```

And the plot of these:

```jldoctest ex; output = false
p1 = plot(plot(exs[:, 1], legend=false, title="Doppler", yticks=[], xticks=[], linewidth=2), plot(exs[:, 2], legend=false, title="Blocks", yticks=[], xticks=[], linewidth=2), plot(exs[:, 3], legend=false, title="Bumps", yticks=[], xticks=[], linewidth=2), plot(exs[:, 4], legend=false, title="HeaviSine", yticks=[], xticks=[], linewidth=2), layout=(1, 4))
p2 = plot(heatmap(identity.(res[:, :, 1])', xticks=false, yticks=[], c=:viridis, colorbar=false), heatmap(identity.(res[:, :, 2])', xticks=false, yticks=[], c=:viridis, colorbar=false), heatmap(identity.(res[:, :, 3])', xticks=false, yticks=[], c=:viridis, colorbar=false), heatmap(identity.(res[:, :, 4])', xticks=false, yticks=[], c=:viridis, colorbar=false), layout=(1, 4))
l = @layout [a{0.3h}; b{0.7h}]
plot(p1, p2, layout=l)

# output

Plot{Plots.GRBackend() n=8}
```

![parallel transforms](/docs/multiEx.svg)

There are also several boundary conditions, depending on the kind of data given; the default `SymBoundary()` symmetrizes the data, while `PerBoundary()` assumes it is periodic, and `ZPBoundary` pads with zeros.
All wavelets are stored in the Fourier domain, and all transforms consist of performing an fft (possibly an rfft if the data is real) of the input, pointwise multiplication (equivalent to convolution in the time domain), and then returning to the time domain.

Perhaps somewhat unusually, the averaging function, or father wavelet, is included as an option (the bottom row for the figure above). This can be either the paired averaging function or uniform in frequency (the `Dirac` averaging). The frequency coverage of the wavelets can be adjusted both in total frequency range both below by the `averagingLength` or above by the `extraOctaves` (caveat emptor with how well they will be defined in that case). The frequency density can be adjusted both in terms of the quality/scale factor `Q`, as well as how quickly this density falls off as the frequency goes to zero via `β`. Finally, depending on what kind of norm you want to preserve, `p` determines the norm preserved in the frequency domain (so `p=1` maintains the 1-norm in frequency, while `p=Inf` maintains the 1-norm in time).

## Possible extensions

- Higher dimensional wavelets have yet to be implemented.
- A DCT implementation of the symmetric boundary to halve the space and computational costs.
